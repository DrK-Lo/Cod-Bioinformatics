scale_y_continuous(limits = c(0, 30), breaks = c(0,5,10,15,20,25,30)) +
labs(title="coverage over chromosomes") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
aggregate(coverage~samp, data = all.samps)
aggregate(coverage~samp, data = all.samps, FUN = mean)
all.samps.ave.cov <- aggregate(coverage~samp, data = all.samps, FUN = mean)
Pop1_17291_samp <- read.table("src/alignment/coverageCalc/Pop1_17291.coverageCalc.txt", fill = TRUE)
Pop1_17291 <- Pop1_17291_samp[,c(1,5,11)]
colnames(Pop1_17291) <- c("chr_name", "chr_size", "reads_mapped")
Pop1_17291$reads_mapped <- as.numeric(as.character(Pop1_17291$reads_mapped))
str(Pop1_17291)
Pop1_17291_readL <- 126
Pop1_17291$totalbases <- Pop1_17291$reads_mapped * Pop1_17291_readL
Pop1_17291$coverage <- Pop1_17291$totalbases/Pop1_17291$chr_size
Pop1_17291$samp <- "Pop1_17291"
Pop4_17236_samp <- read.table("src/alignment/coverageCalc/Pop4_17236.coverageCalc.txt", fill = TRUE)
Pop4_17236 <- Pop4_17236_samp[,c(1,5,11)]
colnames(Pop4_17236) <- c("chr_name", "chr_size", "reads_mapped")
Pop4_17236$reads_mapped <- as.numeric(as.character(Pop4_17236$reads_mapped))
str(Pop4_17236)
Pop4_17236_readL <- 125
Pop4_17236$totalbases <- Pop4_17236$reads_mapped * Pop4_17236_readL
Pop4_17236$coverage <- Pop4_17236$totalbases/Pop4_17236$chr_size
Pop4_17236$samp <- "Pop4_17236"
Pop5_17278_samp <- read.table("src/alignment/coverageCalc/Pop5_17278.coverageCalc.txt", fill = TRUE)
Pop5_17278 <- Pop5_17278_samp[,c(1,5,11)]
colnames(Pop5_17278) <- c("chr_name", "chr_size", "reads_mapped")
Pop5_17278$reads_mapped <- as.numeric(as.character(Pop5_17278$reads_mapped))
str(Pop5_17278)
Pop5_17278_readL <- 127
Pop5_17278$totalbases <- Pop5_17278$reads_mapped * Pop5_17278_readL
Pop5_17278$coverage <- Pop5_17278$totalbases/Pop5_17278$chr_size
Pop5_17278$samp <- "Pop5_17278"
Pop6_18017_samp <- read.table("src/alignment/coverageCalc/Pop6_18017.coverageCalc.txt", fill = TRUE)
Pop6_18017 <- Pop6_18017_samp[,c(1,5,11)]
colnames(Pop6_18017) <- c("chr_name", "chr_size", "reads_mapped")
Pop6_18017$reads_mapped <- as.numeric(as.character(Pop6_18017$reads_mapped))
str(Pop6_18017)
Pop6_18017_readL <- 126
Pop6_18017$totalbases <- Pop6_18017$reads_mapped * Pop6_18017_readL
Pop6_18017$coverage <- Pop6_18017$totalbases/Pop6_18017$chr_size
Pop6_18017$samp <- "Pop6_18017"
all.samps <- rbind(Pop1_16216[1:23,], Pop1_17291[1:23,], Pop4_17236[1:23,], Pop5_17278[1:23,], Pop6_18017[1:23,])
all.samps.ave.cov <- aggregate(coverage~samp, data = all.samps, FUN = mean)
ggplot(data = all.samps, aes(x = chr_name, y = coverage)) +
geom_point(data = all.samps, aes(col = samp)) +
scale_y_continuous(limits = c(0, 30), breaks = c(0,5,10,15,20,25,30)) +
labs(title="coverage over chromosomes") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
all.samps.ave.cov
ggplot(data = all.samps.ave.cov, aes(x = samp, y = coverage)) +
geom_boxplot(data = all.samps.ave.cov, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(0, 30), breaks = c(0,5,10,15,20,25,30)) +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
ggplot(data = all.samps.ave.cov, aes(x = samp, y = coverage)) +
geom_boxplot(data = all.samps.ave.cov, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(0, 30), breaks = c(0,5,10,15,20,25,30)) +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = all.samps, aes(x = samp, y = coverage, group = samp)) +
geom_boxplot(data = all.samps, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(0, 30), breaks = c(0,5,10,15,20,25,30)) +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = all.samps, aes(x = chr_name, y = coverage)) +
geom_point(data = all.samps, aes(col = samp)) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="coverage over chromosomes") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
ggplot(data = all.samps, aes(x = samp, y = coverage, group = samp)) +
geom_boxplot(data = all.samps, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = all.samps, aes(x = chr_name, y = coverage)) +
geom_point(data = all.samps, aes(col = samp)) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Coverage per Chromosomes") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
ggplot(data = all.samps, aes(x = chr_name, y = coverage)) +
geom_point(data = all.samps, aes(col = samp)) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Coverage per Chromosomes",
ylab = "Coverage",
xlab = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
ggplot(data = all.samps, aes(x = chr_name, y = coverage)) +
geom_point(data = all.samps, aes(col = samp)) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Coverage per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
ggplot(data = all.samps, aes(x = samp, y = coverage, group = samp)) +
geom_boxplot(data = all.samps, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = all.samps, aes(x = samp, y = coverage, group = samp)) +
geom_boxplot(data = all.samps, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = all.samps, aes(x = samp, y = coverage, group = samp)) +
geom_boxplot(data = all.samps, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
box.genCov <- ggplot(data = all.samps, aes(x = samp, y = coverage, group = samp)) +
geom_boxplot(data = all.samps, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
scat.chromCov <- ggplot(data = all.samps, aes(x = chr_name, y = coverage)) +
geom_point(data = all.samps, aes(col = samp)) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Coverage per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
arrange(scat.chromCov, box.genCov)
ggarrange(scat.chromCov, box.genCov)
?ggarrange
?arrange
library(ggpubr)
ggarrange(scat.chromCov, box.genCov)
scat.chromCov <- ggplot(data = all.samps, aes(x = chr_name, y = coverage)) +
geom_point(data = all.samps, aes(col = samp)) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Coverage Per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
box.genCov <- ggplot(data = all.samps, aes(x = samp, y = coverage, group = samp)) +
geom_boxplot(data = all.samps, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(15, 30), breaks = c(15,20,25,30)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggarrange(scat.chromCov, box.genCov)
ggarrange(scat.chromCov, box.genCov, labels = c("A", "B"))
(6404686 * 121)/30875876
cod.gff <- read.table("src/alignment/GCF_902167405.1_gadMor3.0_genomic.gff", sep = "\t", quote = "")
chrom.gff <- cod.gff[cod.gff$V3 == "region",]
## split linkage groups up
seq(from = 1, to = 30875876, by = 1000)
## split linkage groups up
seq(from = 1, to = 30875876, by = 10000)
## split linkage groups up
chr1.by10kb <- seq(from = 1, to = 30875876, by = 10000)
tail(chr1.by10kb)
## split linkage groups up
chr1.by10kb <- seq(from = 0, to = 30875876, by = 10000)
head(cchr1.bychr1.by10kb)
head(chr1.by10kb)
tail(chr1.by10kb)
## split linkage groups up
chr1.by10kb <- seq(from = 0, to = 30875876, by = 10000)
## split linkage groups up
chr2.by10kb <- seq(from = 0, to = 28732775, by = 10000)
tail(chr2.by10kb)
## split linkage groups up
chr2.final.loc <- 28732775
chr2.by10k <- seq(from = 0, to = 28732775, by = 10000)
chr2.by10kb <- c(chr2.by10k, chr2.final.loc)
tail(chr2.by10kb)
head(cod.gff)
head(chrom.gff)
length(chr2.by10kb)
paste0("sec", seq(from = 1, to = length(chr2.by10kb), by = 1))
section.names <- paste0("sec", seq(from = 1, to = length(chr2.by10kb), by = 1))
head(chrom.gff)
section.names <- paste0("NC_044049.1.sec", seq(from = 1, to = length(chr2.by10kb), by = 1))
head(chr1.by10kb)
chr2.by10kb.end <- chr2.by10kb+9999
head(chr2.by10kb.end)
chr2.by10kb.start <- c(chr2.by10k, chr2.final.loc)
chr2.by10kb.end <- chr2.by10kb+9999
cbind(section.names, chr2.by10kb.start, chr2.by10kb.end)
as.matrix(cbind(section.names, chr2.by10kb.start, chr2.by10kb.end))
chr2.by10k <- seq(from = 0, to = 28732775, by = 10000)
chr2.by10kb.start <- c(chr2.by10k, chr2.final.loc)
chr2.by10kb.end <- chr2.by10kb+9999
section.names <- paste0("NC_044049.1.sec", seq(from = 1, to = length(chr2.by10kb), by = 1))
chr2.10kb <- as.matrix(cbind(section.names, chr2.by10kb.start, chr2.by10kb.end))
df.chr2.10kb <- as.matrix(cbind(section.names, chr2.by10kb.start, chr2.by10kb.end))
write.table(df.chr2.10kb, "src/alignment/GCF_902167405.1_gadMor3.0_chr2by10kb.gff", row.names = FALSE,
sep = "\t", col.names = FALSE, quote = FALSE)
Pop1_17291_samp <- read.table("src/alignment/coverageCalc/Pop6_18017.GenCovCalc.txt")
Pop6_18017_samp <- read.table("src/alignment/coverageCalc/Pop6_18017.GenCovCalc.txt")
Pop6_18017_genCov <- read.table("src/alignment/coverageCalc/Pop6_18017.GenCovCalc.txt")
Pop6_18017_genCov$samp <- "Pop6_18017"
head(Pop6_18017)
head(Pop6_18017_genCov)
colnames(Pop6_18017_genCov) <- c("chr_name", "coverage", "baseCount_withCov", "chr_size", "frac_bases")
head(Pop6_18017_genCov)
Pop6_18017_genCov <- read.table("src/alignment/coverageCalc/Pop6_18017.GenCovCalc.txt")
colnames(Pop6_18017_genCov) <- c("chr_name", "coverage", "baseCount_withCov", "chr_size", "frac_bases")
Pop6_18017_genCov$samp <- "Pop6_18017"
head(Pop6_18017_genCov)
Pop6_18017_genCov$numBase_x_Cov <- Pop6_18017_genCov$coverage * Pop6_18017_genCov$baseCount_withCov
aggregate(c(numBase_x_Cov, baseCount_withCov)~chr_name, FUN = sum, data = Pop6_18017_genCov)
aggregate(numBase_x_Cov~chr_name, FUN = sum, data = Pop6_18017_genCov)
head(Pop6_18017_genCov)
df.sums <- aggregate(cbind(numBase_x_Cov, baseCount_withCov)~chr_name, FUN = sum, data = Pop6_18017_genCov)
df.sums
df.sums[3:25,]
df.chrom <- df.sums[3:25,]
df.chrom
df.chrom$aveCov <- df.sums$numBase_x_Cov/df.sums$baseCount_withCov
df.chrom$aveCov <- df.chrom$numBase_x_Cov/df.chrom$baseCount_withCov
df.chrom
Pop5_17278_genCov <- read.table("src/alignment/coverageCalc/Pop5_17278.GenCovCalc.txt")
Pop6_18017_genCov <- read.table("src/alignment/coverageCalc/Pop6_18017.GenCovCalc.txt")
Pop6_18017_genCov$samp <- "Pop6_18017"
df.Pop6_18017.chrom <- Pop6_18017_genCov[3:25,]
Pop5_17278_genCov$samp <- "Pop5_17278"
df.Pop5_17278.chrom <- Pop5_17278_genCov[3:25,]
Pop4_17236_genCov <- read.table("src/alignment/coverageCalc/Pop4_17236.GenCovCalc.txt")
Pop4_17236_genCov$samp <- "Pop4_17236"
df.Pop4_17236.chrom <- Pop4_17236_genCov[3:25,]
Pop1_17291_genCov <- read.table("src/alignment/coverageCalc/Pop1_17291.GenCovCalc.txt")
Pop1_17291_genCov$samp <- "Pop1_17291"
df.Pop1_17291.chrom <- Pop1_17291_genCov[3:25,]
Pop1_16216_genCov <- read.table("src/alignment/coverageCalc/Pop1_16216.GenCovCalc.txt")
Pop1_16216_genCov$samp <- "Pop1_16216"
df.Pop1_16216.chrom <- Pop1_16216_genCov[3:25,]
df.all.data <- rbind(Pop6_18017_genCov, Pop5_17278_genCov, Pop4_17236_genCov, Pop1_17291_genCov, Pop1_16216_genCov)
colnames(Pop6_18017_genCov) <- c("chr_name", "coverage", "baseCount_withCov", "chr_size", "frac_bases", "samp")
df.all.data$numBase_x_Cov <- df.all.data$coverage * df.all.data$baseCount_withCov
df.all.data
colnames(df.all.data) <- c("chr_name", "coverage", "baseCount_withCov", "chr_size", "frac_bases", "samp")
df.all.data$numBase_x_Cov <- df.all.data$coverage * df.all.data$baseCount_withCov
df.sums <- aggregate(cbind(numBase_x_Cov, baseCount_withCov)~samp + chr_name, FUN = sum, data = df.all.data)
df.sums$aveCov <- df.sums$numBase_x_Cov/df.sums$baseCount_withCov
scat.chromCov.gen <- ggplot(data = df.sums, aes(x = chr_name, y = aveCov)) +
geom_point(data = df.sums, aes(col = samp)) +
scale_y_continuous(limits = c(0, 20), breaks = c(0,5,10,15,20)) +
labs(title="Coverage Per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
box.genCov.gen <- ggplot(data = df.sums, aes(x = samp, y = aveCov, group = samp)) +
geom_boxplot(data = df.sums, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(0, 20), breaks = c(0,5,10,15,20)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggarrange(scat.chromCov, box.genCov, labels = c("A", "B"))
ggarrange(scat.chromCov.gen, box.genCov,gen, labels = c("A", "B"))
ggarrange(scat.chromCov.gen, box.genCov.gen, labels = c("A", "B"))
scat.chromCov.gen
df.sums$
df.sums
df.all.data <- rbind(df.Pop6_18017_genCov.chrom, df.Pop5_17278_genCov.chrom, df.Pop4_17236_genCov.chrom,
df.Pop1_17291_genCov.chrom, df.Pop1_16216_genCov.chrom)
df.all.data <- rbind(df.Pop6_18017.chrom, df.Pop5_17278.chrom, df.Pop4_17236.chrom,
df.Pop1_17291.chrom, df.Pop1_16216.chrom)
colnames(df.all.data) <- c("chr_name", "coverage", "baseCount_withCov", "chr_size", "frac_bases", "samp")
df.all.data$numBase_x_Cov <- df.all.data$coverage * df.all.data$baseCount_withCov
df.sums <- aggregate(cbind(numBase_x_Cov, baseCount_withCov)~samp + chr_name, FUN = sum, data = df.all.data)
df.sums$aveCov <- df.sums$numBase_x_Cov/df.sums$baseCount_withCov
scat.chromCov.gen <- ggplot(data = df.sums, aes(x = chr_name, y = aveCov)) +
geom_point(data = df.sums, aes(col = samp)) +
scale_y_continuous(limits = c(0, 20), breaks = c(0,5,10,15,20)) +
labs(title="Coverage Per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
box.genCov.gen <- ggplot(data = df.sums, aes(x = samp, y = aveCov, group = samp)) +
geom_boxplot(data = df.sums, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(0, 20), breaks = c(0,5,10,15,20)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggarrange(scat.chromCov.gen, box.genCov.gen, labels = c("A", "B"))
box.genCov.gen <- ggplot(data = df.all.data, aes(x = samp, y = aveCov, group = samp)) +
geom_boxplot(data = df.all.data, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(0, 20), breaks = c(0,5,10,15,20)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
box.genCov.gen
all.samps
df.all.data
df.sums
df.sums <- aggregate(cbind(numBase_x_Cov, baseCount_withCov)~samp + chr_name, FUN = sum, data = df.all.data)
df.sums
df.all.data <- rbind(df.Pop6_18017.chrom, df.Pop5_17278.chrom, df.Pop4_17236.chrom,
df.Pop1_17291.chrom, df.Pop1_16216.chrom)
colnames(df.all.data) <- c("chr_name", "coverage", "baseCount_withCov", "chr_size", "frac_bases", "samp")
df.all.data$numBase_x_Cov <- df.all.data$coverage * df.all.data$baseCount_withCov
df.sums <- aggregate(cbind(numBase_x_Cov, baseCount_withCov)~samp + chr_name, FUN = sum, data = df.all.data)
df.sums$aveCov <- df.sums$numBase_x_Cov/df.sums$baseCount_withCov
df.sums
df.all.data
Pop6_18017_genCov <- read.table("src/alignment/coverageCalc/Pop6_18017.GenCovCalc.txt")
Pop6_18017_genCov$samp <- "Pop6_18017"
head(Pop6_18017_genCov)
tail(Pop6_18017_genCov)
Pop6_18017_genCov <- read.table("src/alignment/coverageCalc/Pop6_18017.GenCovCalc.txt")
Pop6_18017_genCov$samp <- "Pop6_18017"
Pop6_18017_genCov <- read.table("src/alignment/coverageCalc/Pop6_18017.GenCovCalc.txt")
Pop6_18017_genCov$samp <- "Pop6_18017"
Pop5_17278_genCov <- read.table("src/alignment/coverageCalc/Pop5_17278.GenCovCalc.txt")
Pop5_17278_genCov$samp <- "Pop5_17278"
Pop4_17236_genCov <- read.table("src/alignment/coverageCalc/Pop4_17236.GenCovCalc.txt")
Pop4_17236_genCov$samp <- "Pop4_17236"
Pop1_17291_genCov <- read.table("src/alignment/coverageCalc/Pop1_17291.GenCovCalc.txt")
Pop1_17291_genCov$samp <- "Pop1_17291"
Pop1_16216_genCov <- read.table("src/alignment/coverageCalc/Pop1_16216.GenCovCalc.txt")
Pop1_16216_genCov$samp <- "Pop1_16216"
df.all.data <- rbind(Pop6_18017_genCov, Pop5_17278_genCov, Pop4_17236_genCov,
Pop1_17291_genCov, Pop1_16216_genCov)
colnames(df.all.data) <- c("chr_name", "coverage", "baseCount_withCov", "chr_size", "frac_bases", "samp")
df.all.data$numBase_x_Cov <- df.all.data$coverage * df.all.data$baseCount_withCov
df.sums <- aggregate(cbind(numBase_x_Cov, baseCount_withCov)~samp + chr_name, FUN = sum, data = df.all.data)
df.sums$aveCov <- df.sums$numBase_x_Cov/df.sums$baseCount_withCov
df.sums
df.sums[11:(6*23),]
df.sums[11:(125),]
df.sums[11:(126),]
df.sums[11:(125),]
scat.chromCov.gen <- ggplot(data = df.chroms, aes(x = chr_name, y = aveCov)) +
geom_point(data = df.sums, aes(col = samp)) +
scale_y_continuous(limits = c(0, 20), breaks = c(0,5,10,15,20)) +
labs(title="Coverage Per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
df.chroms <- df.sums[11:125,]
scat.chromCov.gen <- ggplot(data = df.chroms, aes(x = chr_name, y = aveCov)) +
geom_point(data = df.chroms, aes(col = samp)) +
scale_y_continuous(limits = c(0, 20), breaks = c(0,5,10,15,20)) +
labs(title="Coverage Per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
scat.chromCov.gen
scat.chromCov.gen <- ggplot(data = df.chroms, aes(x = chr_name, y = aveCov)) +
geom_point(data = df.chroms, aes(col = samp)) +
scale_y_continuous(limits = c(0, 25), breaks = c(0,5,10,15,20, 25)) +
labs(title="Coverage Per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
scat.chromCov.gen
scat.chromCov.gen <- ggplot(data = df.chroms, aes(x = chr_name, y = aveCov)) +
geom_point(data = df.chroms, aes(col = samp)) +
scale_y_continuous(limits = c(10, 25), breaks = c(10,15,20,25)) +
labs(title="Coverage Per Chromosomes",
y = "Coverage",
x = "Chromosome Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1"))
box.genCov.gen <- ggplot(data = df.all.data, aes(x = samp, y = aveCov, group = samp)) +
geom_boxplot(data = df.all.data, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(10, 25), breaks = c(10,15,20,25)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggarrange(scat.chromCov.gen, box.genCov.gen, labels = c("A", "B"))
box.genCov.gen <- ggplot(data = df.chroms, aes(x = samp, y = aveCov, group = samp)) +
geom_boxplot(data = df.all.data, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(10, 25), breaks = c(10,15,20,25)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggarrange(scat.chromCov.gen, box.genCov.gen, labels = c("A", "B"))
box.genCov.gen <- ggplot(data = df.chroms, aes(x = samp, y = aveCov, group = samp)) +
geom_boxplot(data = df.chroms, aes(col = samp)) +
scale_color_manual(values = wes_palette(n=5, name="Darjeeling1")) +
scale_y_continuous(limits = c(10, 25), breaks = c(10,15,20,25)) +
labs(title="Average Coverage Over Chromosomes Per Sample",
y = "Coverage",
x = "Sample Name") +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggarrange(scat.chromCov.gen, box.genCov.gen, labels = c("A", "B"))
cod.gff <- read.table("src/alignment/GCF_902167405.1_gadMor3.0_genomic.gff", sep = "\t", quote = "")
chrom.gff <- cod.gff[cod.gff$V3 == "region",]
head(chrom.gff)
head(chrom.gff$V1, n = 23)
head(chrom.gff$V1, n = 24)
head(chrom.gff$V1, n = 23)
scaffolds.gff <- cod.gff[cod.gff$V3 == "region",]
chrom.gff <- scaffolds[1:23,]
chrom.gff <- scaffolds.gff[1:23,]
chrom.gff
write.table(chrom.gff, "src/alignment/GCF_902167405.1_gadMor3.0_genomic_chroms.gff", row.names = FALSE,
sep = "\t", col.names = FALSE, quote = FALSE)
