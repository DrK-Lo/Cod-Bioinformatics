df.samples$SampleID != "16_237_Gm"
df.samples$SampleID != "16_230_Gm"
df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", ]
ncol(df.samples)
df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", ncol(df.samples)]
df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", ]
dim(df.samples[df.samples$SampleID != "18_102_Gm" &
df.samples$SampleID != "18_016_Gm" &
df.samples$SampleID != "16_237_Gm" &
df.samples$SampleID != "16_230_Gm", ])
dim(df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", ])
df.samples[df.samples$SampleID != "18_102_Gm" &
df.samples$SampleID != "18_016_Gm" &
df.samples$SampleID != "16_237_Gm" &
df.samples$SampleID != "16_230_Gm", ncol(df.samples)]
## Remove samples that we aren't using due to library prep mistake
write.table(df.samples[df.samples$SampleID != "18_102_Gm" &
df.samples$SampleID != "18_016_Gm" &
df.samples$SampleID != "16_237_Gm" &
df.samples$SampleID != "16_230_Gm", ncol(df.samples)],
"src/SampleNames.txt", row.names = FALSE, col.names = FALSE)
# Read in Sample Name table
sampleNames <- read.table("src/SampleNames.txt")
colnames(sampleNames) <- "sampID"
nrow(sampleNames)
?paste0
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filname, ".2.fq.gz"
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filname, ".2.trimmed.fq.gz --cut_front --cut_tail
--cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filname, ".2.fq.gz ",
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filname, ".2.trimmed.fq.gz --cut_front --cut_tail
--cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
i <- 1
filename <- sampleNames$sampID[i]
filename
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filname, ".2.fq.gz ",
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filname, ".2.trimmed.fq.gz --cut_front --cut_tail
--cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filename, ".2.fq.gz ",
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filename, ".2.trimmed.fq.gz --cut_front --cut_tail
--cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filename, ".2.fq.gz ",
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filename, ".2.trimmed.fq.gz --cut_front --cut_tail",
" --cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
IDs <- read.csv("src/SampleNames.csv")
nrow(IDs)
ncol(IDs)
nrow(unique(IDs))
duplicated(IDs)
IDs <- IDs[1:300,]
write.csv("src/SampleNames.csv")
?write.csv
write.csv(IDs, "src/SampleNames.csv")
colnames(IDs) <- "SampID"
write.csv(IDs, "src/SampleNames.csv")
str(IDs)
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE)
sampleNames <- sampNames[1:300,]
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE)
sampNames
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE,row.names = TRUE)
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE, row.names = FALSE)
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE, row.names = FALSE)
sampleNames <- sampNames[1:300,2]
sampleNames
sampleNames <- sampNames[,2]
sampleNames
# Read in Sample Name table
sampleNames <- read.csv("src/SampleNames.txt", header = FALSE)
colnames(sampleNames) <- "ID"
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2019-11-15",
paste0("pear -f FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
getwd()
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
paste0("pear -f FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
warnings()
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"source activate lotterhos-py38",
"module load lotterhos/2020-08-24"
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"source activate lotterhos-py38",
"module load lotterhos/2020-08-24",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=1Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=1Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=8:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=1Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=8:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=Pear_submissionFiles/outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=Pear_submissionFiles/outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=1Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=8:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=Pear_submissionFiles/outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=Pear_submissionFiles/outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
sampleNames <- read.csv("src/SampleNames.txt", header = FALSE)
colnames(sampleNames) <- "ID"
i <- 1
sampleNames[i]
sampleNames$ID[i]
getwd()
for(i in 1:nrow(sampleNames)){
#filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("src/BWA/submissionFiles/", sampleNames$ID[i], "_submitBWA.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitBWA.txt",sep=""),
"#SBATCH --mem=10Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=BWA_Out/jobSum/clustOut/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=BWA_Out/jobSum/clustOut/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("bwa mem GCF_902167405.1_gadMor3.0_genomic.fna.gz FastP_Out/",
sampleNames$ID[i],".R1.fq.gz FastP_Out/",sampleNames$ID[i],
".R2.fq.gz  > BWA_Out/",sampleNames$ID[i],
"aln.sam -O 5 -B 3",
sep = "")
), fileConn)
##system(paste("sbatch submissionFiles/",filename))
}
for(i in 1:nrow(sampleNames)){
#filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("src/BWA/submissionFiles/", sampleNames$ID[i], "_submitBWA.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitBWA.txt",sep=""),
"#SBATCH --mem=10Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=BWA_Out/clustOut/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=BWA_Out/clustOut/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("bwa mem GCF_902167405.1_gadMor3.0_genomic.fna.gz FastP_Out/",
sampleNames$ID[i],".R1.fq.gz FastP_Out/",sampleNames$ID[i],
".R2.fq.gz  > BWA_Out/",sampleNames$ID[i],
"aln.sam -O 5 -B 3",
sep = "")
), fileConn)
##system(paste("sbatch submissionFiles/",filename))
}
sampleNames <- read.csv("src/SampleNames.txt", header = FALSE)
colnames(sampleNames) <- "ID"
for(i in 1:nrow(sampleNames)){
#filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("src/BWA/submissionFiles/", sampleNames$ID[i], "_submitBWA.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitBWA.txt",sep=""),
"#SBATCH --mem=3Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=15:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=.BWA_out/clustOut/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=BWA_out/clustOut/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("bwa mem BWA_genome/GCF_902167405.1_gadMor3.0_genomic.fna FastP_Out/",
sampleNames$ID[i],".R1.fq.gz FastP_Out/",sampleNames$ID[i],
".R2.fq.gz  > BWA_Out/",sampleNames$ID[i],
"aln.sam -O 5 -B 3",
sep = "")
), fileConn)
##system(paste("sbatch submissionFiles/",filename))
}
sampleNames <- read.csv("src/SampleNames.txt", header = FALSE)
colnames(sampleNames) <- "ID"
for(i in 1:nrow(sampleNames)){
#filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("src/BWA/submissionFiles/", sampleNames$ID[i], "_submitBWA.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitBWA",sep=""),
"#SBATCH --mem=3Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=15:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=.BWA_out/clustOut/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=BWA_out/clustOut/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("bwa mem BWA_genome/GCF_902167405.1_gadMor3.0_genomic.fna FastP_Out/",
sampleNames$ID[i],".R1.fq.gz FastP_Out/",sampleNames$ID[i],
".R2.fq.gz  > BWA_Out/",sampleNames$ID[i],
"aln.sam -O 5 -B 3",
sep = "")
), fileConn)
##system(paste("sbatch submissionFiles/",filename))
}
sampleNames <- read.csv("src/SampleNames.txt", header = FALSE)
colnames(sampleNames) <- "ID"
getwd()
for(i in 1:nrow(sampleNames)){
#filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("src/alignment/submissionFiles/", sampleNames$ID[i], "_submitAlnCheck.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_alnCheck",sep=""),
"#SBATCH --mem=2Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=4:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=BWA_Out/clustOut/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=BWA_Out/clustOut/",sampleNames$ID[i],".%j.err"),
"module load samtools/1.9",
paste0("samtools view -Sbt ../BWA_genome/GCF_902167405.1_gadMor3.0_genomic.fna ../BWA_Out/",
sampleNames$ID[i],"alnDef.sam | samtools flagstat - > samtools_alnCheck_Out/",sampleNames$ID[i],
"alnCheck.txt",
sep = "")
), fileConn)
##system(paste("sbatch submissionFiles/",filename))
}
for(i in 1:nrow(sampleNames)){
#filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("src/alignment/submissionFiles/", sampleNames$ID[i], "_submitAlnCheck.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_alnCheck",sep=""),
"#SBATCH --mem=2Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=4:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=samtools_alnCheck_Out/clustOut/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=samtools_alnCheck_Out/clustOut/",sampleNames$ID[i],".%j.err"),
"module load samtools/1.9",
paste0("samtools view -Sbt ../BWA_genome/GCF_902167405.1_gadMor3.0_genomic.fna ../BWA_Out/",
sampleNames$ID[i],"alnDef.sam | samtools flagstat - > samtools_alnCheck_Out/",sampleNames$ID[i],
"alnCheck.txt",
sep = "")
), fileConn)
##system(paste("sbatch submissionFiles/",filename))
}
for(i in 1:nrow(sampleNames)){
#filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("src/alignment/submissionFiles/", sampleNames$ID[i], "_submitAlnCheck.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_alnCheck",sep=""),
"#SBATCH --mem=2Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=4:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=samtools_alnCheck_Out/clustOut/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=samtools_alnCheck_Out/clustOut/",sampleNames$ID[i],".%j.err"),
"module load samtools/1.9",
paste0("samtools view -Sbt BWA_genome/GCF_902167405.1_gadMor3.0_genomic.fna BWA_Out/",
sampleNames$ID[i],"alnDef.sam | samtools flagstat - > samtools_alnCheck_Out/",sampleNames$ID[i],
"alnCheck.txt",
sep = "")
), fileConn)
##system(paste("sbatch submissionFiles/",filename))
}
for(i in 1:nrow(sampleNames)){
#filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("src/alignment/submissionFiles/", sampleNames$ID[i], "_submitAlnCheck.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_alnCheck",sep=""),
"#SBATCH --mem=2Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=4:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=samtools_alnCheck_Out/clustOut/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=samtools_alnCheck_Out/clustOut/",sampleNames$ID[i],".%j.err"),
"module load samtools/1.9",
paste0("samtools view -Sbt BWA_genome/GCF_902167405.1_gadMor3.0_genomic.fna BWA_Out/",
sampleNames$ID[i],"aln.sam | samtools flagstat - > samtools_alnCheck_Out/",sampleNames$ID[i],
"alnCheck.txt",
sep = "")
), fileConn)
##system(paste("sbatch submissionFiles/",filename))
}
getwd()
getwd()
### Analyzing Alignment Output ###
folder <- "src/alignment/alignCheckFiles/multiqc_data/"
alignResults <- read.table(paste(folder, "multiqc_samtools_flagstat.txt", sep = ""), header = TRUE, stringsAsFactors = FALSE)
paste(folder, "multiqc_samtools_flagstat.txt", sep = "")
alignResults
alignResults <- read.table(paste(folder, "multiqc_samtools_flagstat.txt", sep = ""), header = TRUE, stringsAsFactors = FALSE)
alignResults <- read.csv(paste(folder, "multiqc_samtools_flagstat.csv", sep = ""), header = TRUE, stringsAsFactors = FALSE)
head(alignResults)
alignResults <- read.csv(paste(folder, "multiqc_samtools_flagstat.csv", sep = ""), header = TRUE, stringsAsFactors = FALSE)
head(alignResults)
alignResults$megaBases_seq <- alignResults$total_passed * 300 / 10^6
head(aliignResults)
head(alignResults)
alignResults$coverage <- alignResults$megaBases_seq /613
hist(alignResults$coverage)
alignResults$coverage
alignResults$megaBases_seq <- (alignResults$total_passed * 300) / 10^6
alignResults$coverage <- alignResults$megaBases_seq /613
hist(alignResults$coverage)
head(alignResults)
alignResults$mapped_passed <- (alignResults$mapped_passed * 300) / 10^6
alignResults <- read.csv(paste(folder, "multiqc_samtools_flagstat.csv", sep = ""), header = TRUE, stringsAsFactors = FALSE)
alignResults$megaBases_seq <- (alignResults$total_passed * 300) / 10^6
alignResults$megaBases_mapped <- (alignResults$mapped_passed * 300) / 10^6
alignResults$coverage <- alignResults$megaBases_mapped /613
hist(alignResults$coverage)
sum(alignResults$megaBases_seq)
