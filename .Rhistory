primer_combos <- unique(paste(df.samples$i5.Primer, df.samples$i7.Primer, sep = ""))
adapterSeq <- read.csv("../Stacks/Barcode_Sequences.csv", header = FALSE)
df.samples <- read.csv("../Stacks/SequencePlateOrder_updates.csv")
df.samples <- read.csv("../../Stacks/SequencePlateOrder_updates.csv")
getwd()
df.samples <- read.csv("/src/Stacks/SequencePlateOrder_updates.csv")
df.samples <- read.csv("src/Stacks/SequencePlateOrder_updates.csv")
df.popIDs <- read.csv("src/Stacks/Population_IDs.csv")
df.popIDs
year00 <- substr(df.samples$SampleID, start= 1, stop= 2)
sample000 <- substr(df.samples$SampleID, start = 4, stop = 6)
df.samples$Sample5digit <- paste(year00, sample000, sep = "")
df.samples
for(i in 1:nrow(df.popIDs)){
for(j in 1:nrow(df.samples)){
if(df.popIDs$PopLoc[i] == df.samples$Population[j]){
df.samples$file_name_R1[j] <- paste(df.popIDs$PopID[i], "_", df.samples$Sample5digit[j], ".1.fq.gz", sep = "")
df.samples$file_name_R2[j] <- paste(df.popIDs$PopID[i], "_", df.samples$Sample5digit[j], ".2.fq.gz", sep = "")
df.samples$file_name_R1rem[j] <- paste(df.popIDs$PopID[i], "_", df.samples$Sample5digit[j], ".rem.1.fq.gz", sep = "")
df.samples$file_name_R2rem[j] <- paste(df.popIDs$PopID[i], "_", df.samples$Sample5digit[j], ".rem.2.fq.gz", sep = "")
df.samples$PopID[j] <- paste(df.popIDs$PopID[i])
}
}
}
#install.packages("stringr")
library(stringr)
primer_combos <- unique(paste(df.samples$i5.Primer, df.samples$i7.Primer, sep = ""))
adapterSeq <- read.csv("../Stacks/Barcode_Sequences.csv", header = FALSE)
colnames(adapterSeq) <- c("AdaptNum", "AdaptSeq")
adapterSeq <- read.csv("src/Stacks/Barcode_Sequences.csv", header = FALSE)
colnames(adapterSeq) <- c("AdaptNum", "AdaptSeq")
primer_combos
adapterSeq
head(df.samples)
df.samples$NewSampleID<- paste(df.samples$PopID, "_", df.samples$Sample5digit, sep = "")
head(df.samples)
getwd()
write.csv(df.samples, "src/SequencePlateOrder_20200618.csv")
# Read in Sample Name table
sampleNames <- read.csv("SequencePlateOrder_20200618.csv")
# Read in Sample Name table
sampleNames <- read.csv("src/SequencePlateOrder_20200618.csv")
sampleNames <- sampleNames$NewSampleID
head(sampleNames)
#write.csv(df.samples, "src/SequencePlateOrder_20200618.csv")
write.csv(df.samples$NewSampleID, "src/SampleNames.csv")
# Read in Sample Name table
sampleNames <- read.csv("src/SampleNames.csv")
sampleNames
#write.csv(df.samples, "src/SequencePlateOrder_20200618.csv")
write.csv(df.samples$NewSampleID, "src/SampleNames.csv", row.names = FALSE)
# Read in Sample Name table
sampleNames <- read.csv("src/SampleNames.csv")
head(sampleNames)
colnames(sampleNames)
#write.csv(df.samples, "src/SequencePlateOrder_20200618.csv")
write.table(df.samples$NewSampleID, "src/SampleNames.txt", row.names = FALSE)
sampleNames <- read.table("src/SampleNames.csv")
head(sampleNames)
#write.csv(df.samples, "src/SequencePlateOrder_20200618.csv")
write.table(df.samples$NewSampleID, "src/SampleNames.txt", row.names = FALSE, col.names = FALSE)
sampleNames <- read.table("src/SampleNames.csv")
head(sampleNames)
sampleNames <- read.table("src/SampleNames.txt")
head(sampleNames)
dim(sampleNames)
colnames(sampleNames) <- "sampID"
nrow(sampleNames)
df.samples$NewSampleID[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm"]
df.samples$NewSampleID[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm",]
df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", df.samples$NewSampleID]
df.samples$SampleID
df.samples$SampleID != "18_102_Gm"
df.samples$SampleID != "18_016_Gm"
df.samples$SampleID != "16_237_Gm"
df.samples$SampleID != "16_230_Gm"
df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", ]
ncol(df.samples)
df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", ncol(df.samples)]
df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", ]
dim(df.samples[df.samples$SampleID != "18_102_Gm" &
df.samples$SampleID != "18_016_Gm" &
df.samples$SampleID != "16_237_Gm" &
df.samples$SampleID != "16_230_Gm", ])
dim(df.samples[df.samples$SampleID != "18_102_Gm" |
df.samples$SampleID != "18_016_Gm" |
df.samples$SampleID != "16_237_Gm" |
df.samples$SampleID != "16_230_Gm", ])
df.samples[df.samples$SampleID != "18_102_Gm" &
df.samples$SampleID != "18_016_Gm" &
df.samples$SampleID != "16_237_Gm" &
df.samples$SampleID != "16_230_Gm", ncol(df.samples)]
## Remove samples that we aren't using due to library prep mistake
write.table(df.samples[df.samples$SampleID != "18_102_Gm" &
df.samples$SampleID != "18_016_Gm" &
df.samples$SampleID != "16_237_Gm" &
df.samples$SampleID != "16_230_Gm", ncol(df.samples)],
"src/SampleNames.txt", row.names = FALSE, col.names = FALSE)
# Read in Sample Name table
sampleNames <- read.table("src/SampleNames.txt")
colnames(sampleNames) <- "sampID"
nrow(sampleNames)
?paste0
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filname, ".2.fq.gz"
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filname, ".2.trimmed.fq.gz --cut_front --cut_tail
--cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filname, ".2.fq.gz ",
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filname, ".2.trimmed.fq.gz --cut_front --cut_tail
--cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
i <- 1
filename <- sampleNames$sampID[i]
filename
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filname, ".2.fq.gz ",
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filname, ".2.trimmed.fq.gz --cut_front --cut_tail
--cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filename, ".2.fq.gz ",
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filename, ".2.trimmed.fq.gz --cut_front --cut_tail
--cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
paste0("fastp --in1 ", filename, ".1.fg.gz --in2 ", filename, ".2.fq.gz ",
"--out1 ", filename, ".1.trimmed.fq.gz --out2 ", filename, ".2.trimmed.fq.gz --cut_front --cut_tail",
" --cut_window_size 5 --cut_mean_quality 15 --correction $TW -q 15 -u 50" )
IDs <- read.csv("src/SampleNames.csv")
nrow(IDs)
ncol(IDs)
nrow(unique(IDs))
duplicated(IDs)
IDs <- IDs[1:300,]
write.csv("src/SampleNames.csv")
?write.csv
write.csv(IDs, "src/SampleNames.csv")
colnames(IDs) <- "SampID"
write.csv(IDs, "src/SampleNames.csv")
str(IDs)
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE)
sampleNames <- sampNames[1:300,]
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE)
sampNames
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE,row.names = TRUE)
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE, row.names = FALSE)
# Read in Sample Name table
sampNames <- read.csv("src/SampleNames.csv", header = TRUE, row.names = FALSE)
sampleNames <- sampNames[1:300,2]
sampleNames
sampleNames <- sampNames[,2]
sampleNames
# Read in Sample Name table
sampleNames <- read.csv("src/SampleNames.txt", header = FALSE)
colnames(sampleNames) <- "ID"
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2019-11-15",
paste0("pear -f FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
getwd()
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
paste0("pear -f FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
warnings()
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"source activate lotterhos-py38",
"module load lotterhos/2020-08-24"
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"source activate lotterhos-py38",
"module load lotterhos/2020-08-24",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=100Mb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=1Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=1:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=1Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=8:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=1Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=8:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=Pear_submissionFiles/outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=Pear_submissionFiles/outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f ../FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r ../FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o ../Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
for(i in 1:nrow(sampleNames)){
filename <- as.character(sampleNames$ID[i])
fileConn <- file(print(paste("scripts/mergeReads/submissionFiles/", sampleNames$ID[i], "_submitPear.sh", sep="")))
writeLines(c("#!/bin/bash",
paste("#SBATCH --job-name=",sampleNames$ID[i],"_submitPear.txt",sep=""),
"#SBATCH --mem=1Gb",
"#SBATCH --mail-user=schaal.s@northeastern.edu",
"#SBATCH --mail-type=FAIL",
"#SBATCH --partition=lotterhos",
"#SBATCH --time=8:00:00",
"#SBATCH --nodes=1",
"#SBATCH --tasks-per-node=1",
paste0("#SBATCH --output=Pear_submissionFiles/outFiles/",sampleNames$ID[i],".%j.out"),
paste0("#SBATCH --error=Pear_submissionFiles/outFiles/",sampleNames$ID[i],".%j.err"),
"module load lotterhos/2020-08-24",
"source activate lotterhos-py38",
paste0("pear -f FastP_Out/",sampleNames$ID[i],".R1.fq.gz -r FastP_Out/",sampleNames$ID[i],
".R2.fq.gz -o Pear_Out/",sampleNames$ID[i],".R1.fq.gz -n 50", sep = "")
), fileConn)
}
